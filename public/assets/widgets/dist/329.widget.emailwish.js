"use strict";(self.webpackChunkemailwish_widgets=self.webpackChunkemailwish_widgets||[]).push([[329],{3329:function(e,t,n){n.r(t),n.d(t,{AttachmentWidget:function(){return Be},default:function(){return r}});var z=n(5893),G=n(7294),R=n(1607),L=(n(7938),n(4566)),V=n(170),U=n(7850),Y=n(2014),J=n(2318),q=n(7812),K=n(727),X=n(7397),Q=n(7726),$=n(3910),ee=n(129),te=n(3585),l=n(6370),m=function(){return(m=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]]);return n};function ne(e){var t=e.children,n=u(e,["children"]),a=(0,G.useState)(!1),o=a[0],i=a[1],e=(0,G.useState)(!1),a=e[0],s=e[1],r=o||a,e=(0,G.useCallback)(function(){i(!0)},[]),o=(0,G.useCallback)(function(){i(!1)},[]),d=(0,G.useCallback)(function(){s(!0)},[]),c=(0,G.useCallback)(function(){s(!1)},[]),a=(0,G.useMemo)(function(){return{renderer:function(e){var t=e.elementRef,n=e.style,e=u(e,["elementRef","style"]);return(0,z.jsx)("span",m({},e,{ref:t,style:m(m({},n),{opacity:r?1:0,transition:"opacity 0.4s ease-in-out"}),onMouseEnter:d,onMouseLeave:c}),void 0)}}},[r,d,c]);return(0,z.jsx)(l.ZP,m({},n,{wrapperProps:{renderer:function(e){var t=e.elementRef,n=e.style,e=u(e,["elementRef","style"]);return(0,z.jsx)("div",m({},e,{ref:t,style:m(m({},n),{right:0})}),void 0)}},trackXProps:a,trackYProps:a,onScrollStart:e,onScrollStop:o,scrollDetectionThreshold:500},{children:t}),void 0)}var a=n(7484),ae=n.n(a),oe=n(9805),ie=n(7342),o=n(4110),i=n.n(o),t=n(178),a=n.n(t),o=n(660),t=n.n(o),se=n(1749),re=n(282),de=n(366),ce=n(6775),le=n(8137),me=n(6616),ue=n(1437),he=n(4662),o=n(4184),pe=n.n(o),o=n(1171),ge=n.n(o),o=n(2427),s=n(150),xe=(0,o.Z)(function(t){var e;return(0,s.Z)({root:function(e){return{position:"fixed",width:"max-content",display:"flex",flexDirection:"column",height:"max-content",bottom:"16px",right:"32px",zIndex:2e3}},SubmitButton:function(e){return{padding:"8px",paddingInline:"16px",fontSize:"12px",backgroundColor:e.primary_background_color,color:e.primary_text_color}},feedSubmitButton:function(e){return{marginTop:"8px",padding:"8px",paddingInline:"16px",fontSize:"12px",backgroundColor:e.primary_background_color,color:e.primary_text_color}},textEdit:function(e){return{color:e.secondary_text_color,boxSizing:"content-box!important"}},mobileChatOpenRoot:{position:"fixed",width:"95vw",top:"8px",display:"flex",justifyContent:"flex-start",alignItems:"center",flexDirection:"column",height:"95vh",zIndex:2e3},chatButtonWrapper:((e={display:"flex",justifyContent:"flex-end",pointerEvents:"none"})[t.breakpoints.down("sm")]={},e),chatButton:function(e){return{width:"56px",height:"56px",background:e.primary_background_color,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"50%",cursor:"pointer",padding:"8px",pointerEvents:"all"}},chatIcon:function(e){return{width:"24px",color:e.primary_text_color,userSelect:"none"}},chatIconMin:function(e){return{width:"40px",color:e.primary_text_color,userSelect:"none"}},chatWindow:function(e){e={width:"360px",height:"calc(100vh - 9rem)",background:e.secondary_background_color,paddingBottom:"0px",marginBottom:"8px",boxShadow:"0 3px 20px 0 rgb(0 0 0 / 5%)",display:"flex",flexDirection:"column"};return e[t.breakpoints.down("sm")]={width:"unset",height:"calc(100vh - 5rem)",marginBottom:"0",padding:"8px"},e},ratingWrapper:function(e){return{display:"flex"}},chatWindowInnerWrapper:{height:"100%",display:"flex",flexDirection:"column"},chatWindowHeader:function(e){return{padding:"8px",paddingInline:"12px",marginInline:"16px",marginTop:"16px",display:"flex",flexDirection:"column",background:e.primary_background_color,borderRadius:"8px"}},chatWindowHeader_1:{padding:"1.6px",paddingTop:"8px",display:"flex",alignItems:"center"},chatWindowHeader_InfoWrapper:{padding:"8px",justifyContent:"space-between",display:"flex",alignItems:"center"},chatWindowHeader_endChatButton:function(e){return{color:e.primary_text_color,background:e.primary_background_color,"&:hover":{color:e.primary_text_color,background:e.primary_background_color}}},chatWindowHeader_Info_type:function(e){return{fontSize:"13.92px",color:e.primary_text_color}},chatHeaderName:function(e){return{fontWeight:500,color:e.primary_text_color}},chatHeaderImage:{width:"64px",height:"64px",borderRadius:"50%",objectFit:"cover"},chatHeaderActiveIcon:{width:"8px",height:"8px",borderRadius:"50%",background:"lawngreen"},chatHeaderStatusText:function(e){return{color:e.primary_text_color}},rateUsText:function(e){return{color:e.secondary_text_color,fontSize:"20px"}},chatHeaderExpandIcon:function(e){return{color:e.primary_text_color}},chatWindowHeader_2:{padding:"8px"},chatBody:{flexGrow:1,paddingTop:"8px",display:"flex",flexDirection:"column"},chatBodyMessageItemWrapper:{},chatBodyMessageItem:{marginBottom:"16px",display:"flex",flexDirection:"column",paddingInline:"16px"},chatBodyMessageItemGuest:{display:"flex",flexDirection:"column",alignItems:"flex-end"},chatBodyMessageItemAdmin:{display:"flex",flexDirection:"column",alignItems:"flex-start"},chatBodyMessageItemGuestText:function(e){return{display:"flex",flexDirection:"column",justifyContent:"flex-end",color:e.guest_message_text_color,backgroundColor:e.guest_message_background_color,borderRadius:"8px",padding:"12px",paddingInline:"24px"}},chatBodyMessageItemGuestInfo:{display:"flex",alignItems:"center",justifyContent:"flex-end"},chatBodyMessageItemGuestInfoDate:function(e){return{paddingInline:"4px"}},chatBodyMessageItemGuestInfoIcon:{paddingInline:"4px"},chatBodyMessageItemGuestInfoIconItem:function(e){return{width:"18px",color:e.secondary_text_color}},chatBodyMessageItemAdminForm:{},chatBodyMessageItemAdminText:function(e){return{minWidth:"150px",display:"flex",flexDirection:"column",justifyContent:"flex-end",color:e.admin_message_text_color,backgroundColor:e.admin_message_background_color,borderRadius:"8px",padding:"4px",paddingInline:"16px"}},chatBodyMessageItemAdminTextAfter:function(e){return{position:"relative",height:"16px",width:"16px",transform:"rotate(45deg)",bottom:"-8px",backgroundColor:e.admin_message_background_color}},chatBodyMessageItemAdminTextTypo:function(e){return{color:e.admin_message_text_color,marginTop:"8px",marginBottom:"-4.8px"}},chatBodyMessageItemGuestTextTypo:function(e){return{color:e.guest_message_text_color}},chatBodyMessageItemAdminInfo:{display:"flex",alignItems:"center"},chatBodyMessageItemAdminInfoDate:function(e){return{width:"100%",minHeight:"12px",display:"flex",justifyContent:"flex-end",paddingInline:"4px"}},chatBodyMessageItemAdminInfoDateTypo:function(e){return{color:e.secondary_text_color,fontSize:"11px"}},chatBodyMessageItemGuestInfoDateTypo:function(e){return{color:e.secondary_text_color,fontSize:"11px"}},chatBodyMessageItemAdminSenderInfo:{},chatBodyMessageItemAdminSenderInfoName:{},chatBodyMessageItemAdminSenderInfoNameTypo:function(e){return{color:e.secondary_text_color,fontSize:"14px",paddingLeft:"8px"}},chatBodyMessageItemAdminSenderImageInfo:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover"},chatBodyMessageItemAdminInfoIcon:{},chatFooter:{paddingInline:"16px"},chatFooterInput:{marginBottom:"8px"},chatFooterInputAttachment:{display:"flex",alignItems:"center",justifyContent:"space-between"},chatFooterInputAttachmentTextWrapper:{display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},chatFooterInputAttachmentText:function(e){return{fontSize:"13px",color:e.secondary_text_color,width:"250px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},chatFooterInputAttachmentFileSize:function(e){return{color:e.secondary_text_color,fontSize:"13px",textOverflow:"ellipsis"}},chatFooterInputAttachmentCloseButton:{},chatFooterInputBox:function(e){return{padding:"16px",border:"none",color:e.input_text_color,boxSizing:"content-box!important",backgroundColor:e.input_background_color,"&:hover":{border:"none"}}},chatFooterInputBox2:function(e){return{}},chatFooterInputBoxInputAdornment:function(e){return{border:"none",backgroundColor:e.input_background_color,boxShadow:"0px 1px 25px 2px #e3e2e26f","&:hover":{border:"none"}}},chatFooterInputIcon:function(e){return{color:e.input_text_color}},chatFooterTextLink:{display:"flex",justifyContent:"center",textDecoration:"none",alignItems:"center",marginBottom:"8px"},chatFooterTextImage:{zIndex:100,width:"16px",height:"auto"},chatFooterText:function(e){return{color:e.secondary_text_color,paddingLeft:"8px"}}})},{classNamePrefix:"ew-chat-"}),fe=n(3457),ve=n(3067),_e=n(7657),ye=n(101),be=n(628),o=n(5933),Ie=n.n(o),je=function(){return(je=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ke=function(e,t){for(var n=0,a=t.length,o=e.length;n<a;n++,o++)e[o]=t[n];return e};ae().extend(i()),ae().extend(a()),ae().extend(t()),ae().updateLocale("en",{relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d mins",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"}});var we=[{id:Math.random(),uid:ge()(),message_type:"bot_message",message:"Hi",from_guest:"0"},{id:Math.random(),uid:ge()(),message_type:"bot_message",message:"Please tell us more about you.",from_guest:"0"},{id:Math.random(),uid:ge()(),message_type:"email_user_form",message:"",from_guest:"0"}],Se=[{id:Math.random(),uid:ge()(),message_type:"bot_message",message:"Hi",from_guest:"0"},{id:Math.random(),uid:ge()(),message_type:"bot_message",message:"Please tell us more about you.",from_guest:"0"},{id:Math.random(),uid:ge()(),message_type:"email_user_form",message:"",from_guest:"0"},{message_type:"email_user_form",message:"Hi!",uid:ge()(),id:Math.random(),updated_at:(new Date).getDate().toString(),created_at:(new Date).getDate().toString(),from_guest:"1",status:""},{message_type:void 0,message:"Hi, How I Help you!",uid:ge()(),id:Math.random(),updated_at:(new Date).getDate().toString(),created_at:(new Date).getDate().toString(),from_guest:"0",status:""}],Ne={.5:"Useless",1:"Useless+",1.5:"Poor",2:"Poor+",2.5:"Ok",3:"Ok+",3.5:"Good",4:"Good+",4.5:"Excellent",5:"Excellent+"};function r(e){var n=e.chat_settings,t=e.preview,a=e.logo_image,i=e.guest_session,s=e.ui_testing,o=e.restart_session,r=xe(n),d=(0,G.useState)(t),c=d[0],l=d[1];(0,G.useEffect)(function(){l(t)},[t]);var m=(0,G.useState)(s?"Hi, I need Help!":""),u=m[0],h=m[1],p=(0,G.useState)(s?"File":void 0),g=p[0],x=p[1],f=(0,G.useRef)(),v=(0,G.useState)(!(i&&i.last_message)),_=v[0],y=v[1],b=(0,_e.Z)(),I=(0,G.useState)([]),j=I[0],k=I[1],e=(0,G.useState)(),w=e[0],S=e[1],d=(0,G.useState)(!0),m=d[0],N=d[1],p=(0,G.useState)(0),B=p[0],Z=p[1],v=(0,G.useState)(0),M=v[0],T=v[1],I=(0,G.useState)(0),e=I[0],C=I[1],F=[{id:Math.random(),uid:ge()(),message_type:"bot_message",message:"Hi "+(i&&i.name)+"!",from_guest:"0"},{id:Math.random(),uid:ge()(),message_type:"bot_message",message:"How can we help you today!",from_guest:"0"}];(0,G.useEffect)(function(){n.font_family&&Ie().load({google:{families:[n.font_family]}})},[n]),(0,G.useEffect)(function(){s&&k(Se)},[s]),(0,G.useEffect)(function(){s||c&&y(!1)},[s,c]),(0,ve.Z)(function(){s||E||_||((!i||!i.last_message)&&M<F.length&&B<we.length?B<we.length&&i&&i&&!i.email?(N(!0),k(function(e){return ke(ke([],e),[we[B]])}),B>=we.length-1&&N(!1),Z(function(e){return e+1}),A()):M<F.length&&i&&i&&i.email&&(N(!0),k(function(e){return ke(ke([],e),[F[M]])}),F.length-1<=M&&N(!1),T(function(e){return e+1}),A()):(N(!1),(new ye.Z).read_messages(i,w).then(function(t){var e;b.current&&(ye.Z.hasError(t)?t.validation_errors&&(t.validation_errors.session_ended?O(!0):O(!1)):(O(!1),t&&t.messages&&0<t.messages.length&&t.messages&&0<t.messages.length&&(t.messages&&t.messages.find(function(e){return"0"===e.from_guest})&&0!==j.length&&D("PLAYING"),k(function(e){return ke(ke([],e),t.messages)}),e=t.messages[t.messages.length-1].id,S(e),A())))})))},2500,!0);var A=(0,G.useCallback)(function(){setTimeout(function(){f&&f.current&&f.current.scrollIntoView({behavior:"smooth",block:"end",inline:"end"})},50)},[f]),W=(0,G.useCallback)(function(e){s||(h(""),(new ye.Z).send_messages(e,g,i,function(e){try{var t=Math.round(e.loaded/e.total*100);C(t)}catch(e){}}).then(function(e){b.current&&(C(0),x(void 0),ye.Z.hasError(e))}))},[s,i,g,b]),P=(0,G.useRef)(null),d=(0,G.useState)("STOPPED"),p=d[0],D=d[1],v=(0,G.useState)("STOPPED"),I=v[0],H=v[1],d=(0,he.default)(),v=(0,ue.Z)(d.breakpoints.down("sm")),d=(0,G.useState)(!1),E=d[0],O=d[1];return(0,z.jsx)(fe.Z,je({theme:(0,U.Z)(je({typography:{fontFamily:"FuturaPT",fontSize:"14px",subtitle1:{color:"black"},htmlFontSize:14,body1:{fontSize:"18px"},button:{textTransform:"capitalize"}},palette:{primary:{main:n.primary_background_color,dark:n.primary_background_color,contrastText:n.primary_text_color},secondary:{main:n.secondary_background_color,contrastText:n.secondary_text_color}}},{typography:{htmlFontSize:14,fontFamily:n.font_family}}))},{children:(0,z.jsxs)("div",je({className:pe()(v&&c?r.mobileChatOpenRoot:r.root),style:{pointerEvents:c?"all":"none"}},{children:[(0,z.jsx)(le.Z,{url:"https://dashboard.emailwish.com/sounds/client_message_recieved.mp3",playStatus:p,loop:!1,onFinishedPlaying:function(){D("STOPPED")}},void 0),(0,z.jsx)(le.Z,{url:"https://dashboard.emailwish.com/sounds/client_message_send.wav",playStatus:I,loop:!1,onFinishedPlaying:function(){H("STOPPED")}},void 0),(0,z.jsx)(V.Z,je({in:c,timeout:100},{children:(0,z.jsx)("div",je({className:r.chatWindow},{children:(0,z.jsxs)("div",je({className:r.chatWindowInnerWrapper},{children:[(0,z.jsxs)("div",je({className:r.chatWindowHeader},{children:[(0,z.jsxs)("div",je({className:r.chatWindowHeader_1},{children:[(0,z.jsx)("img",{src:a,className:r.chatHeaderImage,alt:"user"},void 0),(0,z.jsxs)(Y.Z,je({flexGrow:1,p:1,paddingLeft:2},{children:[(0,z.jsx)(J.Z,je({gutterBottom:!1,className:""+r.chatHeaderName},{children:n.bot_name}),void 0),(0,z.jsxs)(Y.Z,je({display:"flex",alignItems:"center"},{children:[(0,z.jsx)(Y.Z,je({marginRight:1},{children:(0,z.jsx)(J.Z,je({className:r.chatHeaderStatusText},{children:"Active"}),void 0)}),void 0),(0,z.jsx)("div",{className:r.chatHeaderActiveIcon},void 0)]}),void 0)]}),void 0),(0,z.jsxs)(Y.Z,je({display:"flex"},{children:[!E&&(0,z.jsx)(q.Z,je({onClick:function(){j&&0<j.length&&"feedback"!==j[j.length-1].message_type&&(k(function(e){return ke(ke([],e),[{message_type:"feedback",message:"",uid:ge()(),id:Math.random(),updated_at:"",created_at:"",from_guest:"0",status:""}])}),A())},className:r.chatWindowHeader_endChatButton},{children:(0,z.jsx)(de.Z,{},void 0)}),void 0),(0,z.jsx)(q.Z,je({onClick:function(){l(!1),setTimeout(function(){},100)},color:"primary"},{children:(0,z.jsx)(L.Z,{className:r.chatHeaderExpandIcon},void 0)}),void 0)]}),void 0)]}),void 0),(0,z.jsxs)("div",je({className:r.chatWindowHeader_InfoWrapper},{children:[(0,z.jsx)(J.Z,je({align:"center",className:""+r.chatWindowHeader_Info_type},{children:n.info_message}),void 0),E&&(0,z.jsx)(re.Z,je({className:r.chatWindowHeader_endChatButton,onClick:function(){o(),O(!1)}},{children:"Restart Chat"}),void 0)]}),void 0)]}),void 0),(0,z.jsx)("div",je({className:r.chatBody},{children:(0,z.jsx)(ne,je({style:{height:"100%"}},{children:(0,z.jsxs)("div",je({className:r.chatBodyMessageItemWrapper},{children:[j&&j.map(function(e,t){return(0,z.jsxs)(Y.Z,je({className:r.chatBodyMessageItem,alignItems:"1"===e.from_guest?"flex-end":"flex-start"},{children:["1"===e.from_guest&&(0,z.jsxs)("div",je({className:r.chatBodyMessageItemGuest},{children:[(0,z.jsxs)("div",je({className:r.chatBodyMessageItemGuestText},{children:[(0,z.jsx)(Be,{chatMessage:e},void 0),(0,z.jsx)(J.Z,je({className:r.chatBodyMessageItemGuestTextTypo},{children:e.message}),void 0)]}),void 0),(0,z.jsxs)("div",je({className:r.chatBodyMessageItemGuestInfo},{children:[(0,z.jsx)("div",je({className:r.chatBodyMessageItemGuestInfoDate},{children:e.created_at&&(0,z.jsx)("div",je({className:r.chatBodyMessageItemGuestInfoDateTypo},{children:ae()(e.created_at).utc(!0).fromNow()}),void 0)}),void 0),""!==e.created_at&&(0,z.jsxs)("div",je({className:r.chatBodyMessageItemGuestInfoIcon},{children:[e.created_at&&(0,z.jsx)(oe.Z,{className:r.chatBodyMessageItemGuestInfoIconItem},void 0),!e.created_at&&(0,z.jsx)(ie.Z,{className:r.chatBodyMessageItemGuestInfoIconItem},void 0)]}),void 0)]}),void 0)]}),void 0),"0"===e.from_guest&&(0,z.jsxs)("div",je({className:r.chatBodyMessageItemAdmin},{children:["email_user_form"===e.message_type&&(0,z.jsx)("div",je({className:r.chatBodyMessageItemAdminForm},{children:(0,z.jsx)(ee.J9,je({initialValues:{email:"",name:"",submitted:!1},onSubmit:function(e,t){s||(new ye.Z).update_form(e,i).then(function(e){b.current&&(t.setSubmitting(!1),ye.Z.hasError(e)||(t.setFieldValue("submitted",!0),k(function(e){return ke(ke([],e),[{id:Math.random(),uid:ge()(),message_type:"bot_message",message:"Thank you for providing your details.",from_guest:"0"}])}),A()))})},validationSchema:te.Ry({email:te.Z_().email("Please enter valid email").required("Please enter email"),name:te.Z_().required("Please enter your name")})},{children:function(e){var t=e.handleSubmit,n=e.handleChange,a=e.values,o=e.isSubmitting,i=e.touched,s=e.errors;e.setFieldValue;return(0,z.jsx)("form",je({onSubmit:t},{children:(0,z.jsxs)(se.Z,je({container:!0,spacing:1},{children:[(0,z.jsx)(se.Z,je({xs:12,item:!0},{children:(0,z.jsx)(K.Z,{label:"Name",name:"name",variant:"outlined",inputProps:{className:r.textEdit},disabled:a.submitted,value:a.name,onChange:n,placeholder:"Enter your name",fullWidth:!0,error:i&&i.name&&!(!s||!s.name),helperText:i&&i.name&&s&&s.name},void 0)}),void 0),(0,z.jsx)(se.Z,je({xs:12,item:!0},{children:(0,z.jsx)(K.Z,{color:"primary",label:"Email",name:"email",inputProps:{className:r.textEdit},value:a.email,disabled:a.submitted,onChange:n,variant:"outlined",placeholder:"Enter your email address",fullWidth:!0,error:i&&i.email&&!(!s||!s.email),helperText:i&&i.email&&s&&s.email},void 0)}),void 0),(0,z.jsx)(se.Z,je({xs:12,item:!0,justifyContent:"flex-end",container:!0},{children:(0,z.jsx)("div",{children:(0,z.jsxs)(re.Z,je({variant:"contained",type:"submit",className:r.SubmitButton,disabled:o||a.submitted,color:"primary"},{children:[o&&"Submitting",!o&&a.submitted&&"Submitted",!o&&!a.submitted&&"Submit"]}),void 0)},void 0)}),void 0)]}),void 0)}),void 0)}}),void 0)}),void 0),e.message&&(0,z.jsxs)("div",je({className:r.chatBodyMessageItemAdminText},{children:[(0,z.jsx)(Be,{chatMessage:e},void 0),(0,z.jsx)(J.Z,je({className:r.chatBodyMessageItemAdminTextTypo},{children:e.message}),void 0),(0,z.jsx)("div",{className:r.chatBodyMessageItemAdminTextAfter},void 0)]}),void 0),"end_chat"===e.message_type&&(0,z.jsx)("div",je({className:r.chatBodyMessageItemAdminForm},{children:(0,z.jsx)(ee.J9,je({initialValues:{submitted:!1,yes:!1,feedback_stars:5,hover_feedback_stars:-1,feedback_text:""},onSubmit:function(e,t){},validationSchema:te.Ry({})},{children:function(e){var t=e.handleSubmit,n=(e.handleChange,e.values);e.isSubmitting,e.touched,e.errors,e.setFieldValue;return(0,z.jsx)("form",je({onSubmit:t},{children:(0,z.jsx)(se.Z,je({container:!0,spacing:1},{children:!n.submitted&&(0,z.jsx)(se.Z,je({xs:12,item:!0,justifyContent:"flex-end",container:!0},{children:(0,z.jsxs)("div",je({style:{display:"flex",marginTop:"8px"}},{children:[(0,z.jsx)(re.Z,je({variant:"contained",type:"button",className:r.SubmitButton,disabled:n.submitted,color:"primary",onClick:function(){k(function(e){return ke(ke([],e),[{message_type:void 0,message:"No",uid:ge()(),id:Math.random(),updated_at:"",created_at:"",from_guest:"1",status:""}])}),A()}},{children:"No"}),void 0),(0,z.jsx)("div",{style:{padding:"8px"}},void 0),(0,z.jsx)(re.Z,je({variant:"contained",type:"button",className:r.SubmitButton,disabled:n.submitted,color:"primary",onClick:function(){k(function(e){return ke(ke([],e),[{message_type:void 0,message:"Yes",uid:ge()(),id:Math.random(),updated_at:"",created_at:"",from_guest:"1",status:""},{message_type:"feedback",message:"",uid:ge()(),id:Math.random(),updated_at:"",created_at:"",from_guest:"0",status:""}])}),A()}},{children:"Yes"}),void 0)]}),void 0)}),void 0)}),void 0)}),void 0)}}),void 0)}),void 0),"feedback"===e.message_type&&(0,z.jsx)("div",je({className:r.chatBodyMessageItemAdminForm},{children:(0,z.jsx)(ee.J9,je({initialValues:{submitted:!1,feedback_stars:5,hover_feedback_stars:-1,feedback_text:""},onSubmit:function(e,t){},validationSchema:te.Ry({})},{children:function(e){var t=e.handleSubmit,n=e.handleChange,a=e.values,o=(e.isSubmitting,e.touched,e.errors,e.setFieldValue);return(0,z.jsx)("form",je({onSubmit:t},{children:(0,z.jsx)(se.Z,je({container:!0,spacing:1},{children:!a.submitted&&(0,z.jsx)(se.Z,je({xs:12,item:!0,justifyContent:"flex-end",container:!0},{children:(0,z.jsxs)("div",je({style:{marginTop:"8px"}},{children:[(0,z.jsx)(J.Z,je({className:r.rateUsText},{children:"Rate us"}),void 0),(0,z.jsxs)("div",je({className:r.ratingWrapper},{children:[(0,z.jsx)(be.Z,{name:"hover-feedback",value:a.feedback_stars,precision:1,onChange:function(e,t){o("feedback_stars",t)},onChangeActive:function(e,t){o("hover_feedback_stars",t)}},void 0),null!==a.feedback_stars&&(0,z.jsx)(Y.Z,je({ml:2},{children:Ne[-1!==a.hover_feedback_stars?a.hover_feedback_stars:a.feedback_stars]}),void 0)]}),void 0),(0,z.jsx)(K.Z,{variant:"standard",fullWidth:!0,name:"feedback_text",placeholder:"Type your feedback message",inputProps:{className:r.chatFooterInputBox},value:a.feedback_text,onChange:n},void 0),(0,z.jsx)(re.Z,je({variant:"contained",type:"button",className:r.feedSubmitButton,disabled:a.submitted,color:"primary",onClick:function(){s||(k(function(e){return ke(ke([],e),[{message_type:void 0,message:"Rating :"+a.feedback_stars+" \n "+a.feedback_text,uid:ge()(),id:Math.random(),updated_at:"",created_at:"",from_guest:"1",status:""}])}),A(),(new ye.Z).end_session(i,a.feedback_stars,a.feedback_text).then(function(e){b.current&&(ye.Z.hasError(e)||(o("submitted",!0),k(function(e){return ke(ke([],e),[{id:Math.random(),uid:ge()(),message_type:"bot_message",message:"Thank you for chatting with us!",from_guest:"0"}])}),A()))}))}},{children:"Submit Feedback"}),void 0)]}),void 0)}),void 0)}),void 0)}),void 0)}}),void 0)}),void 0),"email_user_form"!==e.message_type&&"bot_message"!==e.message_type&&"end_chat"!==e.message_type&&"feedback"!==e.message_type&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",je({className:r.chatBodyMessageItemAdminInfoDate},{children:""!==e.created_at&&(0,z.jsx)(J.Z,je({className:r.chatBodyMessageItemAdminInfoDateTypo},{children:ae()(e.created_at).utc(!0).fromNow()}),void 0)}),void 0),(0,z.jsxs)("div",je({className:r.chatBodyMessageItemAdminInfo},{children:[(0,z.jsx)("div",je({className:r.chatBodyMessageItemAdminSenderInfo},{children:(0,z.jsx)("img",{alt:"",src:a,className:r.chatBodyMessageItemAdminSenderImageInfo},void 0)}),void 0),(0,z.jsx)("div",je({className:r.chatBodyMessageItemAdminSenderInfoName},{children:(0,z.jsx)(J.Z,je({className:r.chatBodyMessageItemAdminSenderInfoNameTypo},{children:n.bot_name}),void 0)}),void 0)]}),void 0)]},void 0)]}),void 0)]}),e.id)}),m&&(0,z.jsx)(Y.Z,je({className:r.chatBodyMessageItem,alignItems:"flex-start"},{children:(0,z.jsx)("div",{children:(0,z.jsx)(Y.Z,{children:(0,z.jsx)(R.Z,{type:"ThreeDots",color:n.primary_background_color,height:40,width:40},void 0)},void 0)},void 0)}),void 0),(0,z.jsx)("div",{ref:f},void 0)]}),void 0)}),void 0)}),void 0),(0,z.jsxs)("div",je({className:r.chatFooter},{children:[g&&(0,z.jsxs)("div",je({className:r.chatFooterInputAttachment},{children:[(0,z.jsxs)("div",je({className:r.chatFooterInputAttachmentTextWrapper},{children:[(0,z.jsx)("div",{children:(0,z.jsx)(J.Z,je({className:r.chatFooterInputAttachmentText},{children:g.name}),void 0)},void 0),(0,z.jsx)("div",{children:(0,z.jsxs)(J.Z,je({className:r.chatFooterInputAttachmentFileSize},{children:[parseFloat((g.size/1024).toString()).toFixed(2)," KB"]}),void 0)},void 0)]}),void 0),(0,z.jsx)("div",je({className:r.chatFooterInputAttachment},{children:(0,z.jsx)("div",{children:(0,z.jsx)(q.Z,je({onClick:function(){x(void 0)}},{children:(0,z.jsx)(de.Z,{},void 0)}),void 0)},void 0)}),void 0)]}),void 0),0<e&&(0,z.jsx)("div",{children:(0,z.jsx)(me.ZP,{variant:"determinate",value:50},void 0)},void 0),!E&&(0,z.jsxs)("div",je({className:r.chatFooterInput},{children:[(0,z.jsx)("input",{type:"file",id:"file",onChange:function(e){e.target&&e.target.files&&0<e.target.files.length&&x(e.target.files[0])},accept:".png,.jpg,.jpeg",ref:P,style:{display:"none"}},void 0),(0,z.jsx)(K.Z,{variant:"standard",fullWidth:!0,placeholder:"Type a message",inputProps:{className:r.chatFooterInputBox},value:u,onChange:function(e){s||h(e.target.value)},onKeyPress:function(e){s||"Enter"===e.key&&W(u)},InputProps:{endAdornment:(0,z.jsxs)(X.Z,je({position:"end"},{children:[!g&&0===u.trim().length&&(0,z.jsx)(V.Z,je({in:0===u.trim().length,unmountOnExit:!0},{children:(0,z.jsx)(q.Z,je({onClick:function(){P.current.click()}},{children:(0,z.jsx)(Q.Z,{className:r.chatFooterInputIcon},void 0)}),void 0)}),void 0),(0!==u.trim().length||g)&&(0,z.jsx)(V.Z,je({in:0!==u.trim().length||g,mountOnEnter:!0},{children:(0,z.jsx)(q.Z,je({onClick:function(){W(u)},disabled:0!==e},{children:(0,z.jsx)($.Z,{className:r.chatFooterInputIcon},void 0)}),void 0)}),void 0)]}),void 0),className:r.chatFooterInputBoxInputAdornment,disableUnderline:!0}},void 0)]}),void 0),(0,z.jsx)("div",{children:(0,z.jsxs)("a",je({href:"https://www.emailwish.com/",target:"_blank",rel:"noopener noreferrer",className:r.chatFooterTextLink},{children:[(0,z.jsx)("div",{children:(0,z.jsx)("img",{className:r.chatFooterTextImage,src:"https://dashboard.emailwish.com/assets/widgets/dist/assets/images/ew-logo-small.png",alt:"Emailwish logo"},void 0)},void 0),!n.hide_branding&&(0,z.jsx)("div",{children:(0,z.jsx)(J.Z,je({className:r.chatFooterText},{children:"We run on EmailWish"}),void 0)},void 0)]}),void 0)},void 0)]}),void 0)]}),void 0)}),void 0)}),void 0),(!c||!v)&&(0,z.jsx)("div",je({className:r.chatButtonWrapper},{children:(0,z.jsxs)("div",je({className:r.chatButton,onClick:function(){l(function(e){return!e}),setTimeout(function(){},100)}},{children:[!c&&(0,z.jsx)(ce.Z,{className:r.chatIcon},void 0),c&&(0,z.jsx)(L.Z,{className:r.chatIconMin},void 0)]}),void 0)}),void 0)]}),void 0)}),void 0)}var Be=function(e){e=e.chatMessage;return e.attachment_full_url?e&&e.attachment_mime_type&&e.attachment_mime_type.startsWith("image")?(0,z.jsxs)("a",je({href:e.attachment_full_url,target:"_blank",rel:"noopener noreferrer"},{children:[(0,z.jsx)("img",{alt:"attachment",src:e.attachment_full_url,style:{width:250,height:"auto"}},void 0),(0,z.jsx)("br",{},void 0),(0,z.jsxs)(J.Z,je({style:{color:"white"}},{children:["Size: ",e.attachment_size]}),void 0)]}),void 0):(0,z.jsx)("a",je({href:e.attachment_full_url,target:"_blank",rel:"noopener noreferrer"},{children:(0,z.jsxs)(J.Z,{children:["Attachment Size: ",e.attachment_size]},void 0)}),void 0):null}}}]);